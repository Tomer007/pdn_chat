# ğŸ“„ PDN Diagnostic Prompt

---

## 1 Â· Concept

The **PDN method** assigns each user a code combining:

- **Primary Trait** (T = Task-oriented, A = Assertive, P = People-oriented, E = Expressive)
- **Energy Type** (D = Dynamic, S = Stability, F = Flowing)

Matrix:

| Dynamic (D) | Stability (S) | Flowing (F) |
|-------------|---------------|-------------|
| P10         | P2            | P6           |
| E1          | E5            | E9           |
| A7          | A11           | A3           |
| T4          | T8            | T12          |

The number is fixed historically.

---

## 2 Â· Input Contract

Expect JSON format:

```json
{
  "answers": {
    "4": "AP",
    "5": "ET",
    ...
    "41": "TP",
    "43": { "D": 1, "S": 2, "F": 3 },
    ...
    "55": { "D": 2, "S": 1, "F": 3 },
    "57": 6,
    ...
    "74": 4
  }
}
```

- Only accept valid structure (UTF-8, no BOM).
- Invalid input must return:  
  ```json
  { "error": "invalid_input", "detail": "..." }
  ```

---

## 3 Â· Scoring Pipeline

### Stage A â€“ Primary Trait (Q4â€“41)

- Q4â€“22:
  - `"AP"` â†’ +1 to AP
  - `"ET"` â†’ +1 to ET
- Q23â€“41:
  - `"AE"` â†’ +1 to AE
  - `"TP"` â†’ +1 to TP

Trait Mapping:

| Substage A1 â†’ | AP | ET |
|---------------|----|----|
| AE            | A  | E |
| TP            | P  | T |

Dominant trait selected based on totals.  
Tie-breaking proceeds to Stage C.

---

### Stage B â€“ Energy Type (Q43â€“55)

- Rank 1 = +3 points
- Rank 2 = +2 points
- Rank 3 = +1 point

Sum points:

```
energy_scores = { D: Î£pt_D, S: Î£pt_S, F: Î£pt_F }
```

Top energy wins; if tie â†’ defer to Stage C.

---

### Stage C â€“ Validation (Q57â€“74)

Bipolar Validation Pairs:

| Pair | Qs  | Left (Rating 1) | Right (Rating 7) |
|------|-----|-----------------|-----------------|
| 1    | 57â€“58 | A             | T               |
| 2    | 59â€“60 | T             | A               |
| 3    | 61â€“62 | E             | P               |
| 4    | 63â€“64 | P             | E               |

Scoring per rating:

```plaintext
Deviation d = rating - 4
Weight = 1 (Past) or 1.5 (Present)
If d = 0 â†’ ignore.
If d > 0 â†’ add |d| Ã— 2 Ã— weight to Right letter
If d < 0 â†’ add |d| Ã— 2 Ã— weight to Left letter
```

- Add to trait scores from Stage A.
- If new leader exceeds old by 12+, update trait.

---

## 4 Â· Tie-breaking Rules

If trait tie persists:

1. Prioritize "Present" weights in Stage C.
2. If still tied, highest |deviation| wins.
3. If still tied, pick the trait whose energy (D/S/F) is stronger.
4. If still tied, return `"trait":"Undetermined"`.

---

## 5 Â· Output Contract

Return JSON in this exact structure:

```json
{
  "pdn_code": "A7",
  "trait": "A",
  "energy": "D",
  "scores": {
    "A": 0, "T": 0, "P": 0, "E": 0,
    "D": 0, "S": 0, "F": 0
  },
  "explanation": "..."
}
```

**Notes:**

- `scores` must be integers.
- `explanation` must be in Hebrew (â‰¤ 4 clear sentences).
- Mention which questions influenced the result (e.g., "×©××œ×•×ª 60, 68").

---

## 6 Â· Explanation Requirements

Must:

- Highlight 2â€“3 decisive questions/patterns.
- Justify both **Trait** and **Energy**.
- Acknowledge missing input if any.
- Be human-readable, avoiding technical language.

Example:

> "×”×ª×©×•×‘×•×ª ×œ×©××œ×•×ª 68 ×•â€‘74 ×”×“×’×™×©×• ×™×•×–××” ×•× ×—×™×©×•×ª (7 × ×§×•×“×•×ª), ×•×œ×›×Ÿ ×”×—×•×–×§ ×‘×˜×™×¤×•×¡ A. ×‘×× ×¨×’×™×”, ×”×“×™×¨×•×’×™× ×‘×©×œ×‘ B ×”×¢×“×™×¤×• ××ª ×§×¦×‘ ×”×“×™× ××™×•×ª D."

---

## 7 Â· Error Handling

- Missing keys: compute with available data; log notice in explanation:  
  "×©×™× ×œ×‘: ×—×œ×§ ××”×©××œ×•×ª ×—×¡×¨×•×ª, ×ª×™×ª×›×Ÿ ×¡×˜×™×™×ª ×ª×•×¦××”."

- No clear winner:
  ```json
  {
    "pdn_code": "NA",
    "trait": "Undetermined",
    "energy": "Undetermined",
    "scores": {...},
    "explanation": "×ª×™×§×• ××œ× ×‘×–×™×”×•×™, ×™×© ×¦×•×¨×š ×‘×©××œ×•×Ÿ ××™×©×™."
  }
  ```

---

## 8 Â· Pseudocode

```plaintext
Initialize scores: {A:0, T:0, P:0, E:0, D:0, S:0, F:0}

# Stage A
for q in 4..22:
  if ans[q]=="AP": AP+=1
  else if ans[q]=="ET": ET+=1
for q in 23..41:
  if ans[q]=="AE": AE+=1
  else if ans[q]=="TP": TP+=1

Determine primary trait from mapping.

# Stage B
for q in 43..55:
  D += (4 - rank_of_D)
  S += (4 - rank_of_S)
  F += (4 - rank_of_F)

Determine top energy.

# Stage C
for validation pairs:
  deviation = rating - 4
  weight = 1 or 1.5
  if deviation!=0:
    add points to corresponding letter

Final check â†’ promotion if trait changed.

Return final JSON output.
```

---

## 9 Â· Worked Example

Input (partial):

```json
{
  "answers": {
    "4": "AP",
    "5": "ET",
    "23": "AE",
    "43": { "D": 1, "S": 2, "F": 3 },
    "57": 6
  }
}
```

Output:

```json
{
  "pdn_code": "A7",
  "trait": "A",
  "energy": "D",
  "scores": {"A":42, "T":18, "P":14, "E":27, "D":31, "S":24, "F":19},
  "explanation": "×‘×ª×©×•×‘×•×ª ×œ×©××œ×•×ª 68 ×•â€‘74 × ×™×›×¨×” ×“×•××™× × ×˜×™×•×ª ×‘×”×—×œ×˜×™×•×ª ×•×™×•×–××” (A). ×‘×©×œ×‘ ×”×× ×¨×’×™×”, ×§×¦×‘ D ×”×™×” ×”×‘×•×œ×˜ ×‘×™×•×ª×¨."
}
```
## 10 Â· Final Notes
- Always prioritize user accuracy, transparency, and meaningful interpretation.
- Never output markdown (` ``` `) unless specifically instructed.
- Explanations should feel natural and human-coaching in tone.